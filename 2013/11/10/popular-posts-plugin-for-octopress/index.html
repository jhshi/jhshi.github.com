<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Popular Posts Plugin for Octopress - Pearls in Life</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="http://jhshi.me/images/favicon.ico" rel="icon">

<link rel="canonical" href="http://jhshi.me/2013/11/10/popular-posts-plugin-for-octopress/index.html">

        <meta name="author" content="Jinghao Shi" />
        <meta name="keywords" content="popular posts,jekyll,plugin,ruby" />
        <meta name="description" content="This post describes the octopress-popular-posts for Octopress. Although there is one plugin that does the job, it used Google Page Rank to determine if a post is popular or not. I&#39;d like to, however, use the page view of the post as metric." />

            <meta property="fb:app_id" content="156751911645324"/>
        <meta property="og:site_name" content="Pearls in Life" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Popular Posts Plugin for Octopress"/>
        <meta property="og:url" content="http://jhshi.me/2013/11/10/popular-posts-plugin-for-octopress/index.html"/>
        <meta property="og:description" content="This post describes the octopress-popular-posts for Octopress. Although there is one plugin that does the job, it used Google Page Rank to determine if a post is popular or not. I&#39;d like to, however, use the page view of the post as metric."/>
        <meta property="article:published_time" content="2013-11-10" />
            <meta property="article:section" content="octopress" />
            <meta property="article:tag" content="popular posts" />
            <meta property="article:tag" content="jekyll" />
            <meta property="article:tag" content="plugin" />
            <meta property="article:tag" content="ruby" />
            <meta property="article:author" content="Jinghao Shi" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://jhshi.me/theme/css/bootstrap.readable.min.css" type="text/css"/>
    <link href="http://jhshi.me/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://jhshi.me/theme/css/pygments/friendly.css" rel="stylesheet">
    <link href="http://jhshi.me/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://jhshi.me/theme/css/style.css" type="text/css"/>

        <link href="http://jhshi.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Pearls in Life ATOM Feed"/>



        <link href="http://jhshi.me/feeds/octopress.atom.xml" type="application/atom+xml" rel="alternate"
              title="Pearls in Life octopress ATOM Feed"/>

</head>
<body>

    <script>
      window.fbAsyncInit = function() {
        FB.init({
            appId      : "156751911645324",
          xfbml      : true,
          version    : 'v2.11'
        });
        FB.AppEvents.logPageView();
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "https://connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://jhshi.me/" class="navbar-brand">
Pearls in Life            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/home">Home</a></li>
                    <li><a href="/">Blog</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://jhshi.me/blog/archives/index.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://jhshi.me/2013/11/10/popular-posts-plugin-for-octopress/index.html"
                       rel="bookmark"
                       title="Permalink to Popular Posts Plugin for Octopress">
                        Popular Posts Plugin for Octopress
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-11-10T20:08:00-05:00"> Sun 10 November 2013</time>
    </span>



        <span class="label label-default">Category</span>
        <a href="http://jhshi.me/blog/category/octopress/index.html">octopress</a>


<span class="label label-default">Tags</span>
	<a href="http://jhshi.me/blog/tag/popular-posts/index.html">popular posts</a>
        /
	<a href="http://jhshi.me/blog/tag/jekyll/index.html">jekyll</a>
        /
	<a href="http://jhshi.me/blog/tag/plugin/index.html">plugin</a>
        /
	<a href="http://jhshi.me/blog/tag/ruby/index.html">ruby</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>This post describes the <a href="https://github.com/jhshi/octopress-popular-posts">octopress-popular-posts</a> for Octopress. Although
there is <a href="https://github.com/octopress-themes/popular-posts">one plugin</a> that does the job, it used Google Page Rank to
determine if a post is popular or not. I'd like to, however, use the page view
of the post as metric.</p>


<h2>How To Use</h2>
<p>In <a href="/2013/11/10/page-view-plugin-for-octopress/">another post</a>, I described how to use the <a href="https://github.com/jhshi/octopress-page-view">octopress-page-view</a> plugin to
show the PV of each post and the whole site. This plugin depend on that to
generate each post's PV count. So you need to first install that plugin.</p>
<h3>Installation</h3>
<ul>
<li>Clone the repo from Github</li>
</ul>
<div class="highlight"><pre><span class="nb">cd</span> /tmp
git clone https://github.com/jhshi/octopress-popular-posts.git
<span class="nb">cd </span>octopress-popular-posts
</pre></div>


<p>The structure of the directory will look like this</p>
<div class="highlight"><pre>octopress-popular-posts/
|-- _config.yml
|-- plugins
|   `-- popular_posts.rb
|-- README.md
`-- source
    `-- _include
        `-- custom
            `-- asides
                `-- popular_posts.html
</pre></div>


<ul>
<li>
<p>Copy <code>plugins/popular_posts.rb</code> to your <code>plugins</code> directory. And place 
<code>source/include/custom/asides/popular_posts.html</code> in your custom asides directory.</p>
</li>
<li>
<p>Add this asides to your asides list in <code>_config.yml</code></p>
</li>
</ul>
<h3>Configuration</h3>
<p>This plugin doesn't need any special configurations, as long as you set 
<code>octopress-page-view</code> plugin correctly, it should work out of box.</p>
<p>There is one parameters you can tune, though. You can set how many popular posts
will be shown in <code>popular_posts.html</code></p>
<h2>How It Works</h2>
<p><code>octopress-page-view</code> has done all the hard job for us. All we need to do is
just sort the posts by their page view count.</p>
<p>Note that we need to set the <code>priority</code> of this plugin as <code>low</code>, since we reply
on <code>octopress-page-view</code> plugin to run first to generate the PV count.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">PopularPosts</span> <span class="o">&lt;</span> <span class="no">Generator</span>
    <span class="n">safe</span> <span class="ss">:true</span>
    <span class="n">priority</span> <span class="ss">:low</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
      <span class="c1"># require octopress-page-view plugin</span>
      <span class="k">if</span> <span class="o">!</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s1">&#39;page-view&#39;</span><span class="o">]</span>
        <span class="k">return</span>
      <span class="k">end</span>

      <span class="n">popular_posts</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">sort</span> <span class="k">do</span> <span class="o">|</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="o">|</span>
        <span class="c1"># just catch the rare case</span>
        <span class="k">if</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;_pv&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="kp">nil</span> <span class="o">||</span> <span class="n">py</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;_pv&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="kp">nil</span> <span class="k">then</span> <span class="mi">0</span>
        <span class="k">elsif</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;_pv&#39;</span><span class="o">]</span> <span class="o">&gt;</span> <span class="n">py</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;_pv&#39;</span><span class="o">]</span> <span class="k">then</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elsif</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;_pv&#39;</span><span class="o">]</span> <span class="o">&lt;</span> <span class="n">py</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;_pv&#39;</span><span class="o">]</span> <span class="k">then</span> <span class="mi">1</span>
        <span class="k">else</span> <span class="mi">0</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">merge!</span><span class="p">(</span><span class="s1">&#39;popular_posts&#39;</span> <span class="o">=&gt;</span> <span class="n">popular_posts</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>


<p>One trick I did here is that, <code>site</code> object has not <code>data</code> field to merge into,
so I merge the <code>popular_posts</code> data to <code>site.config</code>.</p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://jhshi.me/2013/11/10/page-view-plugin-for-octopress/index.html">Page View Plugin for Octopress</a></li>
        <li><a href="http://jhshi.me/2013/11/17/post-revision-plugin-for-octopress/index.html">Post Revision Plugin For Octopress</a></li>
        <li><a href="http://jhshi.me/2015/10/13/post-revision-plugin-for-pelican/index.html">Post Revision Plugin for Pelican</a></li>
        <li><a href="http://jhshi.me/2014/11/08/replicate-gem-installation/index.html">Replicate Gem Installation</a></li>
    </ul>
</section>
<section class="well" id="related-posts">
      <h4><a href=https://github.com/jhshi/blog_source/commits/master/content/2013-11-10-popular-posts-plugin-for-octopress.markdown>Post History:</a></h4>

      <b>Saturday 07:19 PM, October 10 2015</b><br/><p>fix category</p>
      <b>Saturday 06:06 PM, October 10 2015</b><br/><p>working</p>
</section>
<div class="fb-like" 
     data-href="http://jhshi.me/2013/11/10/popular-posts-plugin-for-octopress/index.html"
     data-layout="standard" 
     data-action="like" 
     data-show-faces="true">
</div>


<div class="fb-comments"
     data-href="http://jhshi.me/2013/11/10/popular-posts-plugin-for-octopress/index.html"
     data-numposts="5"
     data-order-by="reverse_time"
     data-width="100%"
    ></div>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
        <li class="list-group-item"><h4><i class="fa fa-eye"></i><span class="icon-label">0 Hits</span></h4>
    <li class="list-group-item"><h4><i class="fa fa-fire fa-lg"></i><span class="icon-label">Popular Posts</span></h4>
        <ul class="list-group" id="recentposts">
            <li class="list-group-item">
                <a href="http://jhshi.me/2018/02/11/opengl-over-vnc/index.html">
                    OpenGL over VNC
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2018/01/23/fix-vmware-player-3d-support-issue/index.html">
                    Fix VMWare Player 3D Support Issue
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2017/09/29/google-dns-configuration-on-ubuntu-1604/index.html">
                    Google DNS Configuration on Ubuntu 16.04
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2017/09/21/fix-touchpad-natual-scrolling-of-ubuntu-1604-on-thinkpad-x1/index.html">
                    Fix Touchpad Natual Scrolling of Ubuntu 16.04 on Thinkpad X1
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2017/03/06/backing-up-files-using-amazon-glacier/index.html">
                    Backing Up Files Using Amazon Glacier
                </a>
            </li>
        </ul>
    </li>
    <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
        <ul class="list-group" id="recentposts">
            <li class="list-group-item">
                <a href="http://jhshi.me/2018/02/11/opengl-over-vnc/index.html">
                    OpenGL over VNC
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2018/01/23/fix-vmware-player-3d-support-issue/index.html">
                    Fix VMWare Player 3D Support Issue
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2017/09/29/google-dns-configuration-on-ubuntu-1604/index.html">
                    Google DNS Configuration on Ubuntu 16.04
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2017/09/21/fix-touchpad-natual-scrolling-of-ubuntu-1604-on-thinkpad-x1/index.html">
                    Fix Touchpad Natual Scrolling of Ubuntu 16.04 on Thinkpad X1
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/2017/03/06/backing-up-files-using-amazon-glacier/index.html">
                    Backing Up Files Using Amazon Glacier
                </a>
            </li>
        </ul>
    </li>
    <li class="list-group-item"><a href="http://jhshi.me/blog/categories/index.html"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
        <ul class="list-group" id="categories">
            <li class="list-group-item">
                <a href="http://jhshi.me/blog/category/os161/index.html">
                  <i class="fa fa-folder-open fa-lg"></i> os161 [27]
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/blog/category/linux/index.html">
                  <i class="fa fa-folder-open fa-lg"></i> linux [24]
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/blog/category/android/index.html">
                  <i class="fa fa-folder-open fa-lg"></i> android [20]
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/blog/category/errors/index.html">
                  <i class="fa fa-folder-open fa-lg"></i> errors [14]
                </a>
            </li>
            <li class="list-group-item">
                <a href="http://jhshi.me/blog/category/network/index.html">
                  <i class="fa fa-folder-open fa-lg"></i> network [11]
                </a>
            </li>
        </ul>
    </li>
    <li class="list-group-item"><a href="http://jhshi.me/blog/tags/index.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
        <ul class="list-group list-inline tagcloud" id="tags">
            <li class="list-group-item tag-2">
                <a href="http://jhshi.me/blog/tag/aosp/index.html">
                    AOSP
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/backup/index.html">
                    backup
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/beamer/index.html">
                    beamer
                </a>
            </li>
            <li class="list-group-item tag-7">
                <a href="http://jhshi.me/blog/tag/blog/index.html">
                    blog
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/c/index.html">
                    c
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/gdb/index.html">
                    gdb
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/hammerhead/index.html">
                    hammerhead
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/jekyll/index.html">
                    jekyll
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/mac/index.html">
                    mac
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/ns2/index.html">
                    ns2
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/ota/index.html">
                    OTA
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/plugin/index.html">
                    plugin
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/python/index.html">
                    python
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/ruby/index.html">
                    ruby
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/ssh/index.html">
                    ssh
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="http://jhshi.me/blog/tag/synchronization/index.html">
                    synchronization
                </a>
            </li>
            <li class="list-group-item tag-1">
                <a href="http://jhshi.me/blog/tag/syscall/index.html">
                    syscall
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/travis/index.html">
                    travis
                </a>
            </li>
            <li class="list-group-item tag-6">
                <a href="http://jhshi.me/blog/tag/ubuntu/index.html">
                    ubuntu
                </a>
            </li>
            <li class="list-group-item tag-2">
                <a href="http://jhshi.me/blog/tag/vm/index.html">
                    vm
                </a>
            </li>
        </ul>
    </li>
    <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
      <ul class="list-group" id="social">
        <li class="list-group-item"><a href="https://github.com/jhshi"><i class="fa fa-github-square fa-lg"></i> github</a></li>
        <li class="list-group-item"><a href="http://stackoverflow.com/users/963538/jinghao-shi"><i class="fa fa-stack-overflow fa-lg"></i> stack-overflow</a></li>
      </ul>
    </li>

    <li class="list-group-item"><h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
            <a href="https://github.com/jhshi">@jhshi</a> on GitHub
    </li>
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://blue.cse.buffalo.edu" target="_blank">
                blue Systems Group
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://www.buffalo.edu" target="_blank">
                University at Buffalo
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Jinghao Shi
            &middot;
            Updated on 2020-04-02
            &middot; Powered by <a href="https://github.com/jhshi/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://jhshi.me/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://jhshi.me/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://jhshi.me/theme/js/respond.min.js"></script>

    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://jhshi.me/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'jhshi',
                count: 5,
                skip_forks: true,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://jhshi.me/theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-39842003-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a6b8e0310bbbd35"></script>
</body>
</html>